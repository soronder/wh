(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(9),s=n.n(i),c=(n(15),n(3)),r=n(4),u=n(2),l=n(6),h=n(5),d=(n(16),{state:{},token:localStorage.getItem("token"),setToken:function(e,t){localStorage.setItem("token",e),d.token=e,d.name=t},fetchAllMetaData:function(){return d.fetch({path:"/meta"}).then((function(e){return d.state=e,e}))},fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.path,n=e.query;(n=n||{}).token=d.token;var a=new URLSearchParams(n);return fetch("".concat(t,"?").concat(a)).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)}))})),post:function(e){var t=e.path,n=e.query,a=e.headers,o=e.body;(n=n||{}).token=d.token;var i=new URLSearchParams(n);return fetch("".concat(t,"?").concat(i),{method:"POST",headers:a||{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)}))}}),p=n(0),m=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={name:"",password:""},a.changeName=a.changeName.bind(Object(u.a)(a)),a.changePassword=a.changePassword.bind(Object(u.a)(a)),a.onKeyDown=a.onKeyDown.bind(Object(u.a)(a)),a.onSubmit=a.onSubmit.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(d.token)return d.fetch({path:"/loginvalidate"}).then((function(t){var n=t.error,a=t.name;n?e.setState({error:n}):a?e.props.onAuth(a):console.log("Unexpected error")}))}},{key:"changeName",value:function(e){this.setState({name:e.target.value})}},{key:"changePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onKeyDown",value:function(e){13===e.keyCode&&(e.preventDefault(),this.onSubmit())}},{key:"onSubmit",value:function(){var e=this;return this.setState({error:null}),d.post({path:"/login",body:{name:this.state.name,password:this.state.password}}).then((function(t){var n=t.token,a=t.name,o=t.error;o?e.setState({error:o}):n?(d.setToken(n,a),e.props.onAuth(a)):console.log("Unexpected error")}))}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"login",children:Object(p.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(p.jsx)("input",{placeholder:"Name",onKeyDown:this.onKeyDown,onChange:this.changeName}),Object(p.jsx)("input",{type:"password",placeholder:"Password",onKeyDown:this.onKeyDown,onChange:this.changePassword}),Object(p.jsx)("input",{type:"submit",value:"Submit"}),this.state.error&&Object(p.jsx)("div",{className:"error",children:this.state.error})]})})}}]),n}(o.a.Component),b=n(10),j=n.n(b),O=n(7),f=(n(19),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={value:a.props.value||""},a.onKeyDown=a.onKeyDown.bind(Object(u.a)(a)),a.onChange=a.onChange.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"onKeyDown",value:function(e){this.props.onKeyDown&&this.props.onKeyDown(e),13===e.keyCode&&(e.preventDefault(),e.target.value!==this.props.value&&(this.props.onSubmit(e.target.value),e.target.value=null))}},{key:"onChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){return Object(p.jsx)("textarea",{placeholder:this.props.placeholder,value:this.state.value,onKeyDown:this.onKeyDown,onChange:this.onChange,onSubmit:this.props.onSubmit})}}]),n}(o.a.Component));function v(e){var t=e,n="bytes";return e>1e9?(t=e/1e9,n="GB"):e>1e6?(t=e/1e6,n="MB"):e>1e3&&(t=e/1e3,n="KB"),"".concat(Math.floor(t)," ").concat(n)}n(20);var y=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(p.jsx)("div",{className:"comment-list",children:this.props.comments.map((function(e){return Object(p.jsxs)("div",{children:[Object(p.jsx)("span",{className:"time",children:j()(e.time).format("MMM Do YYYY h:mm:ssa")}),Object(p.jsx)("span",{className:"author",children:e.author}),": ",e.comment]},"".concat(e.time).concat(e.author))}))})}}]),n}(o.a.Component),x=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={meta:{},editingDescription:!1},a.submitComment=a.submitComment.bind(Object(u.a)(a)),a.onKeyDownDescription=a.onKeyDownDescription.bind(Object(u.a)(a)),a.editDescription=a.editDescription.bind(Object(u.a)(a)),a.submitDescription=a.submitDescription.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"editDescription",value:function(){this.setState({editingDescription:!0})}},{key:"onKeyDownDescription",value:function(e){27===e.keyCode&&(e.stopPropagation(),this.setState({editingDescription:!1}))}},{key:"submitDescription",value:function(e){var t=this;d.post({path:"/meta",query:{path:this.props.file.path},body:{description:e}}).then((function(e){t.setState({meta:e,editingDescription:!1})}))}},{key:"componentDidMount",value:function(){var e=this;d.fetch({path:"/meta",query:{path:this.props.file.path}}).then((function(t){e.setState({meta:t})}))}},{key:"submitComment",value:function(e){var t=this;d.post({path:"/meta",query:{path:this.props.file.path},body:{comment:e}}).then((function(e){t.setState({meta:e})}))}},{key:"render",value:function(){var e,t,n=this.props,a=n.file;n.dir,n.index;if(this.state.meta){var o=this.state.meta;e=o.description,t=o.comments}return Object(p.jsx)("div",{className:"modal",children:Object(p.jsxs)("div",{className:"modal-body",children:[Object(p.jsxs)("h2",{className:"modal-header",children:[a.name,Object(p.jsx)("span",{onClick:this.props.closeModal,className:"modal-close",children:"X"})]}),Object(p.jsxs)("div",{className:"modal-content",children:[Object(p.jsx)("div",{className:"column",children:Object(p.jsx)("img",{src:"".concat(a.path)})}),Object(p.jsxs)("div",{className:"column",children:[Object(p.jsx)("div",{className:"description",children:this.state.editingDescription?Object(p.jsx)(f,{placeholder:"Add Description...",value:e,onSubmit:this.submitDescription,onKeyDown:this.onKeyDownDescription}):Object(p.jsxs)("div",{children:[e,Object(p.jsx)("i",{className:"far fa-edit",onClick:this.editDescription})]})}),Object(p.jsxs)("div",{className:"comment-box",children:[t?Object(p.jsx)(y,{comments:t}):"No comments",Object(p.jsx)("div",{children:Object(p.jsx)(f,{placeholder:"Add Comment...",onSubmit:this.submitComment})})]})]})]}),Object(p.jsx)("div",{className:"modal-footer"})]})})}}]),n}(o.a.Component),g=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={open:!1},a.closeModal=a.setOpen.bind(Object(u.a)(a),!1),a.openModal=a.setOpen.bind(Object(u.a)(a),!0),a.closeOnEscape=a.closeOnEscape.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"closeOnEscape",value:function(e){27===e.keyCode&&(e.preventDefault(),this.closeModal())}},{key:"setOpen",value:function(e){this.setState({open:e}),e?document.onkeydown=this.closeOnEscape:(document.onkeydown=null,this.props.onModalClose&&this.props.onModalClose())}},{key:"componentDidUpdate",value:function(){document.body.className=document.body.className.replace("modal-open",""),this.state.open&&(document.body.className+=" modal-open")}},{key:"render",value:function(){var e,t,n=this.props,a=n.file,o=n.dir,i=n.index;if(this.props.meta){var s=this.props.meta;e=s.comments,t=s.claimed}return[Object(p.jsxs)("div",{className:"img",style:{backgroundImage:'url("'.concat(a.path,'")')},onClick:this.openModal,children:[e&&e.length>0&&Object(p.jsx)("i",{className:"far fa-".concat(e.length>1?"comments":"comment")}),t&&Object(p.jsx)("i",{className:"fas fa-heart"}),Object(p.jsx)("div",{children:a.name})]},"img"),this.state.open&&Object(p.jsx)(x,{dir:o,file:a,index:i,closeModal:this.closeModal},"modal")]}}]),n}(o.a.Component),k=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={meta:{}},a.onOpen=a.onOpen.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"onOpen",value:function(e){var t=this;d.fetchAllMetaData().then((function(e){t.setState({meta:e})}))}},{key:"render",value:function(){var e=this,t=this.props.dir,a=t.children.reduce((function(e,t){return e+t.size}),0);return Object(p.jsx)(O.a,{allowZeroExpanded:!0,onChange:this.onOpen,children:Object(p.jsxs)(O.b,{children:[Object(p.jsx)(O.d,{children:Object(p.jsxs)(O.c,{children:[t.name,Object(p.jsxs)("span",{children:[t.children.length," items - ",v(a)]})]})}),Object(p.jsx)(O.e,{children:t.children.map((function(a,o){return"directory"===a.type?Object(p.jsx)(n,{dir:a},a.path):"file"===a.type?Object(p.jsx)(g,{file:a,dir:t,index:o,meta:e.state.meta[a.path],onModalClose:e.onOpen},a.path):null}))})]})})}}]),n}(o.a.Component),D=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={dir:null},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;d.fetch({path:"/dir"}).then((function(t){e.setState({dir:t})})),d.fetch({path:"/meta"}).then((function(t){e.setState({meta:t})}))}},{key:"render",value:function(){return this.state.dir?Object(p.jsx)("div",{className:"image-list",children:Object(p.jsx)(k,{dir:this.state.dir})}):null}}]),n}(o.a.Component),S=(n(21),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={authed:!1},a.onAuth=a.onAuth.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"onAuth",value:function(e){this.setState({authed:!0,name:e})}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"App",children:this.state.authed?Object(p.jsx)(D,{}):Object(p.jsx)(m,{onAuth:this.onAuth})})}}]),n}(o.a.Component)),w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),o(e),i(e),s(e)}))};s.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(S,{})}),document.getElementById("root")),w()}},[[22,1,2]]]);
//# sourceMappingURL=main.81b6298b.chunk.js.map